(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2716,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function n(){let e=(0,r.useRef)(null),n=(0,r.useRef)(0),s=(0,r.useRef)(0),a=(0,r.useRef)({background:"#fafafa",foreground:"#171717",muted:"#737373",border:"#e5e5e5"}),o=(0,r.useRef)({screen:"home",score:0,coins:0,combo:0,maxCombo:0,distance:0,speed:4.5,nearMisses:0}),l=(0,r.useRef)({lane:1,targetLane:1,x:0,y:0,rotation:0,switchProgress:1}),c=(0,r.useRef)([]),i=(0,r.useRef)([]),u=(0,r.useRef)([]),d=(0,r.useRef)(0),h=(0,r.useRef)(0),m=(0,r.useRef)(0),[f,g]=(0,r.useState)(o.current),[x,b]=(0,r.useState)(null),[p,v]=(0,r.useState)({width:340,height:600}),y=(0,r.useCallback)(e=>p.width/2-105+70*e+35,[p.width]),w=(e,t,r)=>e+(t-e)*r,k=(0,r.useCallback)(()=>{{let e=getComputedStyle(document.documentElement);a.current={background:e.getPropertyValue("--background").trim()||"#fafafa",foreground:e.getPropertyValue("--foreground").trim()||"#171717",muted:e.getPropertyValue("--muted").trim()||"#737373",border:e.getPropertyValue("--border").trim()||"#e5e5e5"}}},[]),j=[[{lane:0}],[{lane:1}],[{lane:2}],[{lane:0},{lane:1}],[{lane:1},{lane:2}],[{lane:0},{lane:2}]],S=(0,r.useCallback)(()=>{if("playing"!==o.current.screen)return;let e=j[m.current%j.length];m.current++,e.forEach(({lane:e})=>{c.current.push({lane:e,y:-80,width:38,height:38,passed:!1})}),d.current=-80},[]),N=(0,r.useCallback)(()=>{if("playing"!==o.current.screen)return;let e=new Set(c.current.filter(e=>e.y<0&&e.y>-180).map(e=>e.lane)),t=[0,1,2].filter(t=>!e.has(t));if(t.length>0){let e=t[Math.floor(Math.random()*t.length)];i.current.push({lane:e,y:-40,collected:!1})}h.current=-40},[]),P=(0,r.useCallback)((e,t,r)=>{for(let n=0;n<r;n++){let s=2*Math.PI*n/r+.3*Math.random(),a=1+2*Math.random();u.current.push({x:e,y:t,vx:Math.cos(s)*a,vy:Math.sin(s)*a,life:1,maxLife:1,size:2+2*Math.random()})}},[]),C=(0,r.useCallback)(()=>{let e=l.current,t=o.current,r=e.x-16+4,n=e.x+16-4,s=e.y-28+8,a=e.y+28-4;for(let o of c.current){if(o.passed)continue;let l=y(o.lane)-o.width/2,c=y(o.lane)+o.width/2,i=o.y-o.height/2,u=o.y+o.height/2;if(i>a&&!o.passed){o.passed=!0,(e.lane===o.lane||42>Math.abs(e.x-y(o.lane)))&&(t.score+=15,t.nearMisses++,t.combo++,t.combo>t.maxCombo&&(t.maxCombo=t.combo));continue}if(n>l&&r<c&&a>i&&s<u)return!0}for(let r of i.current){if(r.collected)continue;let n=y(r.lane),s=r.y;28>Math.sqrt((e.x-n)**2+(e.y-s)**2)&&(r.collected=!0,t.coins++,t.score+=10,t.combo++,t.combo>t.maxCombo&&(t.maxCombo=t.combo),P(n,s,6))}return!1},[y,P]),M=(0,r.useCallback)(t=>{let r=e.current;if(!r)return;let m=r.getContext("2d");if(!m)return;let f=s.current?(t-s.current)/1e3:.016;s.current=t;let x=o.current,v=l.current,k=a.current;if(m.fillStyle=k.background,m.fillRect(0,0,p.width,p.height),"playing"===x.screen){if(x.speed=Math.min(11,x.speed+8e-4),x.distance+=x.speed,x.score+=1,v.switchProgress<1){let e;v.switchProgress=Math.min(1,v.switchProgress+f/.14);let t=(e=v.switchProgress)*(2-e),r=y(v.lane),n=y(v.targetLane);v.x=w(r,n,t),v.rotation=(v.targetLane-v.lane)*12*(1-t)}else v.lane=v.targetLane,v.x=y(v.lane),v.rotation=w(v.rotation,0,.15);if(c.current.forEach(e=>{e.y+=x.speed}),i.current.forEach(e=>{e.y+=x.speed}),d.current>220&&Math.random()<.015+.004*x.speed&&S(),d.current+=x.speed,h.current>160&&(.35>Math.random()&&N(),h.current=0),h.current+=x.speed,c.current=c.current.filter(e=>e.y<p.height+100),i.current=i.current.filter(e=>e.y<p.height+50&&!e.collected),u.current.forEach(e=>{e.x+=e.vx,e.y+=e.vy,e.life-=3*f}),u.current=u.current.filter(e=>e.life>0),C()){x.screen="gameover",x.combo=0,P(v.x,v.y,12);let e={score:x.score,coins:x.coins,maxCombo:x.maxCombo,date:new Date().toISOString()},t=localStorage.getItem("pingo_highscore"),r=t?JSON.parse(t):null;(!r||x.score>r.score)&&(localStorage.setItem("pingo_highscore",JSON.stringify(e)),b(e)),g({...x}),n.current=requestAnimationFrame(M);return}g({...x})}let j=(p.width-210)/2;m.fillStyle=k.border,m.globalAlpha=.3,m.fillRect(j,0,210,p.height),m.globalAlpha=1,m.strokeStyle=k.border,m.lineWidth=1,m.setLineDash([20,15]);let T=x.distance%35;for(let e=1;e<3;e++){let t=y(e)-35;m.beginPath(),m.moveTo(t,-35+T),m.lineTo(t,p.height),m.stroke()}m.setLineDash([]),m.strokeStyle=k.muted,m.lineWidth=1,m.beginPath(),m.moveTo(j,0),m.lineTo(j,p.height),m.stroke(),m.beginPath(),m.moveTo(j+210,0),m.lineTo(j+210,p.height),m.stroke(),i.current.forEach(e=>{if(e.collected)return;let t=y(e.lane),r=e.y;m.strokeStyle=k.foreground,m.lineWidth=1.5,m.beginPath(),m.arc(t,r,10,0,2*Math.PI),m.stroke(),m.fillStyle=k.foreground,m.beginPath(),m.arc(t,r,3,0,2*Math.PI),m.fill()}),c.current.forEach(e=>{let t=y(e.lane),r=e.y;m.fillStyle=k.foreground,m.fillRect(t-e.width/2,r-e.height/2,e.width,e.height)}),u.current.forEach(e=>{m.globalAlpha=e.life/e.maxLife*.6,m.fillStyle=k.muted,m.beginPath(),m.arc(e.x,e.y,e.size*(e.life/e.maxLife),0,2*Math.PI),m.fill()}),m.globalAlpha=1,("playing"===x.screen||"gameover"===x.screen)&&(m.save(),m.translate(v.x,v.y),m.rotate(v.rotation*Math.PI/180),m.strokeStyle=k.foreground,m.lineWidth=2,m.strokeRect(-16,-28,32,56),m.beginPath(),m.moveTo(-10,-18),m.lineTo(10,-18),m.stroke(),m.lineWidth=1,m.beginPath(),m.moveTo(0,-12),m.lineTo(0,20),m.stroke(),m.restore()),"playing"===x.screen&&(m.fillStyle=k.foreground,m.font='500 20px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',m.textAlign="left",m.fillText(`${x.score}`,20,36),m.fillStyle=k.muted,m.font='400 14px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',m.fillText(`${x.coins}`,20,56),x.combo>1&&(m.fillStyle=k.foreground,m.font='500 16px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',m.textAlign="right",m.fillText(`${x.combo}x`,p.width-20,36))),n.current=requestAnimationFrame(M)},[p,y,C,S,N,P]),T=(0,r.useCallback)(()=>{let e=o.current,t=l.current;"home"===e.screen||"gameover"===e.screen?E():"playing"===e.screen&&t.switchProgress>=.8&&(t.targetLane=(t.targetLane+1)%3,t.switchProgress=0)},[]),E=(0,r.useCallback)(()=>{o.current={screen:"playing",score:0,coins:0,combo:0,maxCombo:0,distance:0,speed:4.5,nearMisses:0},l.current={lane:1,targetLane:1,x:y(1),y:p.height-120,rotation:0,switchProgress:1},c.current=[],i.current=[],u.current=[],d.current=200,h.current=100,m.current=0,g(o.current)},[y,p.height]);return(0,r.useEffect)(()=>{let e=()=>{v({width:Math.min(340,window.innerWidth-40),height:Math.min(600,window.innerHeight-160)})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{"playing"===o.current.screen&&(l.current.y=p.height-120,l.current.x=y(l.current.lane))},[p,y]),(0,r.useEffect)(()=>{let e=localStorage.getItem("pingo_highscore");e&&b(JSON.parse(e))},[]),(0,r.useEffect)(()=>{k();let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{setTimeout(k,50)};return e.addEventListener("change",t),l.current.x=y(1),l.current.y=p.height-120,s.current=0,n.current=requestAnimationFrame(M),()=>{cancelAnimationFrame(n.current),e.removeEventListener("change",t)}},[M,y,p.height,k]),(0,r.useEffect)(()=>{let e=e=>{("Space"===e.code||"ArrowRight"===e.code||"ArrowLeft"===e.code)&&(e.preventDefault(),T())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[T]),(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center px-6 py-12 bg-[var(--background)]",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("canvas",{ref:e,width:p.width,height:p.height,onClick:T,onTouchStart:e=>{e.preventDefault(),T()},className:"cursor-pointer touch-none border border-[var(--border)]"}),"home"===f.screen&&(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[var(--background)]/95 border border-[var(--border)]",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-3",children:"One-Button"}),(0,t.jsx)("h1",{className:"text-3xl font-medium tracking-tight text-[var(--foreground)] mb-8",children:"Drift"}),(0,t.jsxs)("div",{className:"mb-10 text-center",children:[(0,t.jsx)("p",{className:"text-[var(--muted)] text-sm mb-1",children:"Tap or press Space to switch lanes"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Collect coins, avoid obstacles"})]}),(0,t.jsx)("button",{onClick:T,className:"px-8 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Play"}),x&&(0,t.jsxs)("div",{className:"mt-10 text-center",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] mb-1",children:"Best"}),(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:x.score})]})]}),"gameover"===f.screen&&(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[var(--background)]/95 border border-[var(--border)]",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-6",children:"Game Over"}),(0,t.jsx)("p",{className:"text-4xl font-medium text-[var(--foreground)] mb-6",children:f.score}),(0,t.jsxs)("div",{className:"flex gap-10 mb-8 text-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:f.coins}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Coins"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:[f.maxCombo,"x"]}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Combo"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:f.nearMisses}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Near"})]})]}),x&&f.score>=x.score&&(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] mb-6",children:"New best score"}),(0,t.jsx)("button",{onClick:T,className:"px-8 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Play Again"}),x&&f.score<x.score&&(0,t.jsxs)("p",{className:"mt-8 text-xs text-[var(--muted)]",children:["Best: ",x.score]})]}),"playing"===f.screen&&(0,t.jsx)("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2",children:(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"tap anywhere"})})]}),(0,t.jsx)("p",{className:"mt-8 text-xs text-[var(--muted)]",children:"Space / Tap to switch lanes"})]})}e.s(["default",()=>n])}]);