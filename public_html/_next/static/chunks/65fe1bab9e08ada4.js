(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83679,e=>{"use strict";var r=e.i(43476),t=e.i(71645);let s=[[1,2,3],[2,3,4],[3,2,1],[4,3,2]],a={0:"",1:"bg-[var(--foreground)]",2:"bg-[var(--foreground)] opacity-75",3:"bg-[var(--foreground)] opacity-50",4:"bg-[var(--foreground)] opacity-30"};function n(){return Array.from({length:12},()=>[0,0,0])}function o(e){return[Math.floor(4*e())+1,Math.floor(4*e())+1,Math.floor(4*e())+1]}function l(){let[e,l]=(0,t.useState)({screen:"home",grid:n(),incoming:[1,2,3],swapsLeft:2,score:0,turn:0,bestChain:0,mode:"daily",seed:"",autoDropTimer:3e3}),[i,c]=(0,t.useState)({bestScore:0,lastDaily:"",lastDailyScore:0}),[d,x]=(0,t.useState)(!1),m=(0,t.useRef)(()=>Math.random()),u=(0,t.useRef)(null);(0,t.useEffect)(()=>{let e=localStorage.getItem("braidstack_data");e&&c(JSON.parse(e))},[]);let f=(0,t.useCallback)((e,r,t)=>{c(s=>{let a={...s};return e>s.bestScore&&(a.bestScore=e),"daily"===r&&(a.lastDaily=t,a.lastDailyScore=e),localStorage.setItem("braidstack_data",JSON.stringify(a)),a})},[]),h=(0,t.useCallback)(e=>{let{grid:r,incoming:t}=e;if(r[11].some(e=>0!==e))return f(e.score,e.mode,e.seed),{...e,screen:"gameover"};let a=r.map(e=>[...e]);for(let e=11;e>0;e--)a[e]=[...a[e-1]];a[0]=[...t];let{newGrid:n,clearedRows:l,chainWaves:i}=function(e){let r=e.map(e=>[...e]),t=0,a=0;for(;;){let e=[];for(let t=0;t<r.length;t++)(function(e){return 0!==e[0]&&0!==e[1]&&0!==e[2]&&s.some(r=>e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2])})(r[t])&&e.push(t);if(0===e.length)break;for(a++,t+=e.length,r=r.filter((r,t)=>!e.includes(t));r.length<12;)r.unshift([0,0,0])}return{newGrid:r,clearedRows:t,chainWaves:a}}(a),c=10*l;i>1&&(c+=(i-1)*15);let d=o(m.current);return{...e,grid:n,incoming:d,swapsLeft:2,score:e.score+c,turn:e.turn+1,bestChain:Math.max(e.bestChain,i),autoDropTimer:3e3}},[f]);(0,t.useEffect)(()=>{if("playing"===e.screen)return u.current=setInterval(()=>{l(e=>{if("playing"!==e.screen)return e;let r=e.autoDropTimer-100;return r<=0?h(e):{...e,autoDropTimer:r}})},100),()=>{u.current&&clearInterval(u.current)}},[e.screen,h]);let v=(0,t.useCallback)(e=>{let r,t="daily"===e?(r=new Date,`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`):`practice-${Date.now()}`;m.current=function(e){let r=0x811c9dc5;for(let t=0;t<e.length;t++)r^=e.charCodeAt(t),r=Math.imul(r,0x1000193);return function(){return r^=r>>>16,r=Math.imul(r,0x85ebca6b),r^=r>>>13,r=Math.imul(r,0xc2b2ae35),((r^=r>>>16)>>>0)/0x100000000}}(t),l({screen:"playing",grid:n(),incoming:o(m.current),swapsLeft:2,score:0,turn:0,bestChain:0,mode:e,seed:t,autoDropTimer:3e3})},[]),p=(0,t.useCallback)(r=>{"playing"!==e.screen||e.swapsLeft<=0||l(e=>{let t=[...e.incoming];return"left"===r?[t[0],t[1]]=[t[1],t[0]]:[t[1],t[2]]=[t[2],t[1]],{...e,incoming:t,swapsLeft:e.swapsLeft-1}})},[e.screen,e.swapsLeft]),g=(0,t.useCallback)(()=>{"playing"===e.screen&&l(e=>h(e))},[e.screen,h]);(0,t.useEffect)(()=>{let r=r=>{"playing"===e.screen&&("a"===r.key||"A"===r.key||"ArrowLeft"===r.key?(r.preventDefault(),e.swapsLeft>0&&l(e=>{if(e.swapsLeft<=0)return e;let r=[...e.incoming];return[r[0],r[1]]=[r[1],r[0]],{...e,incoming:r,swapsLeft:e.swapsLeft-1}})):"d"===r.key||"D"===r.key||"ArrowRight"===r.key?(r.preventDefault(),e.swapsLeft>0&&l(e=>{if(e.swapsLeft<=0)return e;let r=[...e.incoming];return[r[1],r[2]]=[r[2],r[1]],{...e,incoming:r,swapsLeft:e.swapsLeft-1}})):(" "===r.key||"Enter"===r.key||"ArrowDown"===r.key)&&(r.preventDefault(),l(e=>h(e))))};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e.screen,e.swapsLeft,h]);let b=(0,t.useCallback)(()=>{let{seed:r,score:t,turn:s,bestChain:a}=e,n=`Braidstack ${r}
Score: ${t}
Turns: ${s}
Best chain: x${a}`;navigator.clipboard.writeText(n)},[e]);return(0,r.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center px-6 py-12 bg-[var(--background)]",children:(0,r.jsxs)("div",{className:"w-full max-w-sm",children:["home"===e.screen&&(0,r.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,r.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-3",children:"Triplet Weaving"}),(0,r.jsx)("h1",{className:"text-3xl font-medium tracking-tight text-[var(--foreground)] mb-8",children:"Braidstack"}),(0,r.jsxs)("div",{className:"mb-8 text-center",children:[(0,r.jsx)("p",{className:"text-[var(--muted)] text-sm mb-2",children:"Swap incoming beads before they drop"}),(0,r.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Rows clear when they form runs:"}),(0,r.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"1-2-3, 2-3-4, 3-2-1, or 4-3-2"}),(0,r.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Don't let the stack overflow!"})]}),(0,r.jsxs)("div",{className:"flex gap-3 mb-8",children:[(0,r.jsx)("button",{onClick:()=>v("daily"),className:"px-6 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Daily"}),(0,r.jsx)("button",{onClick:()=>v("practice"),className:"px-6 py-3 text-sm font-medium border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"Practice"})]}),i.bestScore>0&&(0,r.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:["Best: ",i.bestScore]})]}),"playing"===e.screen&&(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsxs)("div",{className:"w-full flex justify-between items-center mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.score}),(0,r.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"score"})]}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("p",{className:"text-sm text-[var(--muted)]",children:[e.swapsLeft," swaps"]})}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.turn}),(0,r.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"turns"})]})]}),(()=>{let{grid:t,incoming:s}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"mb-4 flex gap-1",children:s.map((e,t)=>(0,r.jsx)("div",{className:`flex items-center justify-center border-2 border-[var(--foreground)] text-[var(--background)] font-medium ${a[e]}`,style:{width:48,height:48},children:e},`incoming-${t}`))}),(0,r.jsxs)("div",{className:"flex gap-1 mb-4",children:[(0,r.jsx)("button",{onClick:()=>p("left"),disabled:e.swapsLeft<=0,className:"px-3 py-1 text-xs border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:"L↔M"}),(0,r.jsx)("button",{onClick:g,className:"px-4 py-1 text-xs border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Drop"}),(0,r.jsx)("button",{onClick:()=>p("right"),disabled:e.swapsLeft<=0,className:"px-3 py-1 text-xs border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:"M↔R"})]}),(0,r.jsx)("div",{className:"w-full max-w-[160px] h-1 bg-[var(--border)] mb-4",children:(0,r.jsx)("div",{className:"h-full bg-[var(--foreground)] transition-all duration-100",style:{width:`${e.autoDropTimer/3e3*100}%`}})}),(0,r.jsx)("div",{className:"border border-[var(--border)]",style:{display:"grid",gridTemplateColumns:"repeat(3, 48px)",gap:"3px",padding:3},children:t.map((e,t)=>e.map((e,s)=>(0,r.jsx)("div",{className:`flex items-center justify-center font-medium transition-all duration-150 ${0===e?"bg-[var(--border)]":`${a[e]} text-[var(--background)]`}`,style:{width:48,height:48},children:0!==e&&e},`${t}-${s}`)))})]})})(),(0,r.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,r.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"A/D to swap • Space to drop"}),(0,r.jsx)("button",{onClick:()=>x(!0),className:"px-2 py-1 text-xs border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"?"})]})]}),"gameover"===e.screen&&(0,r.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,r.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-3",children:"Stack Overflow"}),(0,r.jsx)("h2",{className:"text-2xl font-medium text-[var(--foreground)] mb-6",children:"Game Over"}),(0,r.jsx)("p",{className:"text-4xl font-medium text-[var(--foreground)] mb-6",children:e.score}),(0,r.jsxs)("div",{className:"flex gap-8 mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.turn}),(0,r.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Turns"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:["x",e.bestChain]}),(0,r.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Best Chain"})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 mb-6",children:[(0,r.jsx)("button",{onClick:b,className:"px-6 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Copy Share"}),(0,r.jsx)("button",{onClick:()=>v("practice"),className:"px-6 py-3 text-sm font-medium border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"Play Again"})]}),i.bestScore>0&&(0,r.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:["Best: ",i.bestScore]})]}),d&&(0,r.jsx)("div",{className:"fixed inset-0 bg-[var(--background)]/95 flex items-center justify-center p-6 z-50",children:(0,r.jsxs)("div",{className:"max-w-sm text-center",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-[var(--foreground)] mb-4",children:"How to Play"}),(0,r.jsxs)("div",{className:"text-sm text-[var(--muted)] space-y-2 mb-6",children:[(0,r.jsx)("p",{children:"Each turn, you get 3 beads (values 1-4)."}),(0,r.jsx)("p",{children:"You can swap adjacent beads up to 2 times."}),(0,r.jsx)("p",{children:"Beads drop into the stack automatically or on command."}),(0,r.jsx)("p",{children:"Rows clear if they form consecutive runs:"}),(0,r.jsx)("p",{className:"font-mono",children:"1-2-3, 2-3-4, 3-2-1, 4-3-2"}),(0,r.jsx)("p",{children:"Game ends when the stack overflows."})]}),(0,r.jsx)("button",{onClick:()=>x(!1),className:"px-6 py-2 text-sm border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Got it"})]})})]})})}e.s(["default",()=>l])}]);