(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50107,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let s=[{name:"Dot",offsets:[[0,0]],weight:30},{name:"H-Domino",offsets:[[0,0],[1,0]],weight:20},{name:"V-Domino",offsets:[[0,0],[0,1]],weight:20},{name:"H-Line",offsets:[[0,0],[1,0],[2,0]],weight:10},{name:"V-Line",offsets:[[0,0],[0,1],[0,2]],weight:10},{name:"L-Shape",offsets:[[0,0],[1,0],[0,1]],weight:8},{name:"Square",offsets:[[0,0],[1,0],[0,1],[1,1]],weight:2}];function l(){return Array.from({length:7},()=>Array(7).fill(0))}function n(e){return e.map(e=>[...e])}function a(e){let t=s.reduce((e,t)=>e+t.weight,0),r=[];for(let l=0;l<3;l++){let l=e()*t;for(let e=0;e<s.length;e++)if((l-=s[e].weight)<=0){r.push(e);break}}return r}function i(e,t,r,l){for(let[e,n]of s[t].offsets){let t=r+n,s=l+e;if(t<0||t>=7||s<0||s>=7)return!1}return!0}function o(){let[e,o]=(0,r.useState)({screen:"home",grid:l(),spill:0,spillLimit:25,turn:0,score:0,stencilsOffered:[0,1,2],selectedStencil:null,mode:"daily",seed:"",bestBurst:0}),[c,d]=(0,r.useState)({bestScore:0,lastDaily:"",lastDailyScore:0}),[u,x]=(0,r.useState)(null),[m,f]=(0,r.useState)([]),[h,g]=(0,r.useState)(!1),v=(0,r.useRef)(()=>Math.random());(0,r.useEffect)(()=>{let e=localStorage.getItem("inkpressure_data");e&&d(JSON.parse(e))},[]);let p=(0,r.useCallback)((e,t,r)=>{d(s=>{let l={...s};return e>s.bestScore&&(l.bestScore=e),"daily"===t&&(l.lastDaily=r,l.lastDailyScore=e),localStorage.setItem("inkpressure_data",JSON.stringify(l)),l})},[]);(0,r.useEffect)(()=>{let t=t=>{"playing"===e.screen&&("1"===t.key?o(e=>({...e,selectedStencil:0===e.selectedStencil?null:0})):"2"===t.key?o(e=>({...e,selectedStencil:1===e.selectedStencil?null:1})):"3"===t.key?o(e=>({...e,selectedStencil:2===e.selectedStencil?null:2})):("z"===t.key||"Z"===t.key)&&m.length>0&&(o(m[m.length-1]),f(e=>e.slice(0,-1))))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e.screen,m]);let b=(0,r.useCallback)(e=>{let t,r="daily"===e?(t=new Date,`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`):`practice-${Date.now()}`;v.current=function(e){let t=0x811c9dc5;for(let r=0;r<e.length;r++)t^=e.charCodeAt(r),t=Math.imul(t,0x1000193);return function(){return t^=t>>>16,t=Math.imul(t,0x85ebca6b),t^=t>>>13,t=Math.imul(t,0xc2b2ae35),((t^=t>>>16)>>>0)/0x100000000}}(r),o({screen:"playing",grid:l(),spill:0,spillLimit:25,turn:0,score:0,stencilsOffered:a(v.current),selectedStencil:null,mode:e,seed:r,bestBurst:0}),f([])},[]),j=(0,r.useCallback)(e=>{o(t=>({...t,selectedStencil:t.selectedStencil===e?null:e}))},[]),N=(0,r.useCallback)((t,r)=>{if("playing"!==e.screen||null===e.selectedStencil)return;let l=e.stencilsOffered[e.selectedStencil];if(!i(e.grid,l,t,r))return;f(t=>[...t,{...e,grid:n(e.grid)}]);let{newGrid:c,bursts:d,spillInc:u}=function(e){let t=n(e),r=0,s=0,l=[];for(let e=0;e<7;e++)for(let r=0;r<7;r++)t[e][r]>=4&&l.push([e,r]);let a=[[-1,0],[1,0],[0,-1],[0,1]];for(;l.length>0;){let[e,n]=l.shift();for(;t[e][n]>=4;)for(let[i,o]of(t[e][n]-=4,r++,a)){let r=e+i,a=n+o;r>=0&&r<7&&a>=0&&a<7?(t[r][a]+=1,4===t[r][a]&&l.push([r,a])):s++}}return{newGrid:t,bursts:r,spillInc:s}}(function(e,t,r,l){let a=n(e);for(let[e,n]of s[t].offsets){let t=r+n,s=l+e;a[t][s]+=1}return a}(e.grid,l,t,r)),x=e.spill+u,m=x>=e.spillLimit,h=2*d;d>=5&&(h+=(d-4)*3);let g={...e,grid:c,spill:x,turn:e.turn+1,score:e.score+h,stencilsOffered:a(v.current),selectedStencil:null,bestBurst:Math.max(e.bestBurst,d),screen:m?"gameover":"playing"};o(g),m&&p(g.score,e.mode,e.seed)},[e,p]),S=(0,r.useCallback)(()=>{0===m.length||(o(m[m.length-1]),f(e=>e.slice(0,-1)))},[m]),y=(0,r.useCallback)(()=>{let{seed:t,score:r,turn:s,spill:l,spillLimit:n,bestBurst:a}=e,i=`InkPressure ${t}
Score: ${r}
Turns: ${s}
Spill: ${l}/${n}
Best burst: ${a}`;navigator.clipboard.writeText(i)},[e]);return(0,t.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center px-6 py-12 bg-[var(--background)]",children:(0,t.jsxs)("div",{className:"w-full max-w-sm",children:["home"===e.screen&&(0,t.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-3",children:"Sandpile Bursts"}),(0,t.jsx)("h1",{className:"text-3xl font-medium tracking-tight text-[var(--foreground)] mb-8",children:"Ink Pressure"}),(0,t.jsxs)("div",{className:"mb-8 text-center",children:[(0,t.jsx)("p",{className:"text-[var(--muted)] text-sm mb-2",children:"Stamp patterns to build ink counts"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Cells at 4+ burst and spread ink"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Ink that spills off the edge fills the meter"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Game ends when spill meter fills"})]}),(0,t.jsxs)("div",{className:"flex gap-3 mb-8",children:[(0,t.jsx)("button",{onClick:()=>b("daily"),className:"px-6 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Daily"}),(0,t.jsx)("button",{onClick:()=>b("practice"),className:"px-6 py-3 text-sm font-medium border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"Practice"})]}),c.bestScore>0&&(0,t.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:["Best: ",c.bestScore]})]}),"playing"===e.screen&&(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsxs)("div",{className:"w-full flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.score}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"score"})]}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("p",{className:"text-sm text-[var(--foreground)]",children:["Turn ",e.turn+1]})}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:["spill ",e.spill,"/",e.spillLimit]})})]}),(0,t.jsx)("div",{className:"w-full h-2 bg-[var(--border)] mb-4",children:(0,t.jsx)("div",{className:"h-full bg-[var(--foreground)] transition-all duration-200",style:{width:`${e.spill/e.spillLimit*100}%`}})}),(0,t.jsx)("div",{className:"flex gap-2 mb-4",children:e.stencilsOffered.map((r,l)=>(0,t.jsx)("button",{onClick:()=>j(l),className:`p-2 border transition-colors ${e.selectedStencil===l?"border-[var(--foreground)] bg-[var(--foreground)]/10":"border-[var(--muted)] hover:border-[var(--foreground)]"}`,children:(e=>{let r=s[e],l=0,n=0;for(let[e,t]of r.offsets)l=Math.max(l,t),n=Math.max(n,e);return(0,t.jsx)("div",{className:"relative",style:{width:40,height:40},children:r.offsets.map(([e,r],s)=>(0,t.jsx)("div",{className:"absolute bg-[var(--foreground)]",style:{width:8,height:8,left:9*e+(40-(n+1)*9)/2,top:9*r+(40-(l+1)*9)/2}},s))})})(r)},l))}),(()=>{let{grid:r,selectedStencil:l,stencilsOffered:n}=e,a=(()=>{if(null===e.selectedStencil||null===u)return new Set;let t=s[e.stencilsOffered[e.selectedStencil]],[r,l]=u,n=new Set;for(let[e,s]of t.offsets){let t=r+s,a=l+e;t>=0&&t<7&&a>=0&&a<7&&n.add(`${t}-${a}`)}return n})(),o=!!u&&null!==l&&i(r,n[l],u[0],u[1]);return(0,t.jsx)("div",{className:"border border-[var(--border)]",style:{display:"grid",gridTemplateColumns:"repeat(7, 40px)",gap:"2px",padding:2},children:r.map((e,r)=>e.map((e,s)=>{let l=a.has(`${r}-${s}`),n=0===e?.1:Math.min(.3+.2*e,.9);return(0,t.jsx)("div",{className:`flex items-center justify-center text-xs font-medium cursor-pointer transition-all duration-100 ${l&&o?"ring-2 ring-[var(--foreground)]":l&&!o?"ring-2 ring-red-500":""}`,style:{width:40,height:40,backgroundColor:`rgba(var(--foreground-rgb, 23, 23, 23), ${n})`,color:e>=2?"var(--background)":"var(--foreground)"},onClick:()=>N(r,s),onMouseEnter:()=>x([r,s]),onMouseLeave:()=>x(null),children:e>0&&e},`${r}-${s}`)}))})})(),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,t.jsx)("button",{onClick:S,disabled:0===m.length,className:"px-3 py-1 text-xs border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:"Undo"}),(0,t.jsx)("button",{onClick:()=>g(!0),className:"px-2 py-1 text-xs border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"?"})]}),(0,t.jsx)("p",{className:"mt-2 text-xs text-[var(--muted)]",children:"Select a stencil, then click to place"})]}),"gameover"===e.screen&&(0,t.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-3",children:"Ink Overflowed"}),(0,t.jsx)("h2",{className:"text-2xl font-medium text-[var(--foreground)] mb-6",children:"Game Over"}),(0,t.jsx)("p",{className:"text-4xl font-medium text-[var(--foreground)] mb-6",children:e.score}),(0,t.jsxs)("div",{className:"flex gap-8 mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.turn}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Turns"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.bestBurst}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Best Burst"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 mb-6",children:[(0,t.jsx)("button",{onClick:y,className:"px-6 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Copy Share"}),(0,t.jsx)("button",{onClick:()=>b("practice"),className:"px-6 py-3 text-sm font-medium border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"Play Again"})]}),c.bestScore>0&&(0,t.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:["Best: ",c.bestScore]})]}),h&&(0,t.jsx)("div",{className:"fixed inset-0 bg-[var(--background)]/95 flex items-center justify-center p-6 z-50",children:(0,t.jsxs)("div",{className:"max-w-sm text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-[var(--foreground)] mb-4",children:"How to Play"}),(0,t.jsxs)("div",{className:"text-sm text-[var(--muted)] space-y-2 mb-6",children:[(0,t.jsx)("p",{children:"Each turn, pick a stencil and stamp it on the grid."}),(0,t.jsx)("p",{children:"Cells gain +1 ink for each stamp."}),(0,t.jsx)("p",{children:"When a cell reaches 4, it bursts: -4 to self, +1 to neighbors."}),(0,t.jsx)("p",{children:"Bursts can chain reaction!"}),(0,t.jsx)("p",{children:"Ink that bursts off the edge fills the spill meter."}),(0,t.jsxs)("p",{children:["Game ends when spill reaches ",25,"."]})]}),(0,t.jsx)("button",{onClick:()=>g(!1),className:"px-6 py-2 text-sm border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Got it"})]})})]})})}e.s(["default",()=>o])}]);