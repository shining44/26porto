(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2716,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function o(){let e=(0,r.useRef)(null),o=(0,r.useRef)(0),s=(0,r.useRef)(0),n=(0,r.useRef)({background:"#fafafa",foreground:"#171717",muted:"#737373",border:"#e5e5e5"}),a=(0,r.useRef)({screen:"home",score:0,coins:0,combo:0,maxCombo:0,distance:0,speed:4.5,nearMisses:0,boostCharge:0,boostActive:!1,boostTime:0,boostsTriggered:0}),l=(0,r.useRef)({lane:1,targetLane:1,x:0,y:0,rotation:0,switchProgress:1}),i=(0,r.useRef)([]),c=(0,r.useRef)([]),d=(0,r.useRef)([]),u=(0,r.useRef)(0),h=(0,r.useRef)(0),m=(0,r.useRef)(0),[g,x]=(0,r.useState)(a.current),[f,b]=(0,r.useState)(null),[p,v]=(0,r.useState)({width:340,height:600}),y=(0,r.useCallback)(e=>p.width/2-105+70*e+35,[p.width]),w=(e,t,r)=>e+(t-e)*r,k=(0,r.useCallback)(e=>1+Math.min(3,Math.floor(e/4)),[]),S=(0,r.useCallback)(e=>{let t=k(e.combo);return e.boostActive?2*t:t},[k]),j=(0,r.useCallback)(()=>{{let e=getComputedStyle(document.documentElement);n.current={background:e.getPropertyValue("--background").trim()||"#fafafa",foreground:e.getPropertyValue("--foreground").trim()||"#171717",muted:e.getPropertyValue("--muted").trim()||"#737373",border:e.getPropertyValue("--border").trim()||"#e5e5e5"}}},[]),C=[[{lane:0}],[{lane:1}],[{lane:2}],[{lane:0},{lane:1}],[{lane:1},{lane:2}],[{lane:0},{lane:2}]],M=(0,r.useCallback)(()=>{if("playing"!==a.current.screen)return;let e=C[m.current%C.length];m.current++,e.forEach(({lane:e})=>{i.current.push({lane:e,y:-80,width:38,height:38,passed:!1})}),u.current=-80},[]),N=(0,r.useCallback)(()=>{if("playing"!==a.current.screen)return;let e=new Set(i.current.filter(e=>e.y<0&&e.y>-180).map(e=>e.lane)),t=[0,1,2].filter(t=>!e.has(t));if(t.length>0){let e=t[Math.floor(Math.random()*t.length)];c.current.push({lane:e,y:-40,collected:!1})}h.current=-40},[]),T=(0,r.useCallback)((e,t,r)=>{for(let o=0;o<r;o++){let s=2*Math.PI*o/r+.3*Math.random(),n=1+2*Math.random();d.current.push({x:e,y:t,vx:Math.cos(s)*n,vy:Math.sin(s)*n,life:1,maxLife:1,size:2+2*Math.random()})}},[]),A=(0,r.useCallback)(()=>{let e=l.current,t=a.current,r=e.x-16+4,o=e.x+16-4,s=e.y-28+8,n=e.y+28-4;for(let a of i.current){if(a.passed)continue;let l=y(a.lane)-a.width/2,i=y(a.lane)+a.width/2,c=a.y-a.height/2,d=a.y+a.height/2;if(c>n&&!a.passed){a.passed=!0,e.lane===a.lane||24.5>Math.abs(e.x-y(a.lane))?(t.score+=Math.round(18*S(t)),t.nearMisses++,t.combo++,t.combo>t.maxCombo&&(t.maxCombo=t.combo),t.boostCharge=Math.min(100,t.boostCharge+14)):t.combo=0,!t.boostActive&&t.boostCharge>=100&&(t.boostActive=!0,t.boostTime=4.5,t.boostCharge=0,t.boostsTriggered++,T(e.x,e.y,12));continue}if(o>l&&r<i&&n>c&&s<d)return!0}for(let r of c.current){if(r.collected)continue;let o=y(r.lane),s=r.y;28>Math.sqrt((e.x-o)**2+(e.y-s)**2)&&(r.collected=!0,t.coins++,t.score+=Math.round(20*S(t)),t.combo++,t.combo>t.maxCombo&&(t.maxCombo=t.combo),t.boostCharge=Math.min(100,t.boostCharge+22),!t.boostActive&&t.boostCharge>=100&&(t.boostActive=!0,t.boostTime=4.5,t.boostCharge=0,t.boostsTriggered++,T(e.x,e.y,14)),T(o,s,6))}return!1},[y,T,S]),P=(0,r.useCallback)(t=>{let r=e.current;if(!r)return;let m=r.getContext("2d");if(!m)return;let g=s.current?(t-s.current)/1e3:.016;s.current=t;let f=a.current,v=l.current,j=n.current;if(m.fillStyle=j.background,m.fillRect(0,0,p.width,p.height),"playing"===f.screen){f.speed=Math.min(11,f.speed+8e-4),f.boostActive&&(f.boostTime=Math.max(0,f.boostTime-g),0===f.boostTime&&(f.boostActive=!1));let e=2.2*!!f.boostActive,t=f.speed+e;if(f.distance+=t,f.score+=Math.round((1+.08*f.speed)*S(f)),v.switchProgress<1){let e;v.switchProgress=Math.min(1,v.switchProgress+g/.14);let t=(e=v.switchProgress)*(2-e),r=y(v.lane),o=y(v.targetLane);v.x=w(r,o,t),v.rotation=(v.targetLane-v.lane)*12*(1-t)}else v.lane=v.targetLane,v.x=y(v.lane),v.rotation=w(v.rotation,0,.15);if(i.current.forEach(e=>{e.y+=t}),c.current.forEach(e=>{e.y+=t}),u.current>220&&Math.random()<.015+.004*f.speed&&M(),u.current+=t,h.current>160&&(.35>Math.random()&&N(),h.current=0),h.current+=t,i.current=i.current.filter(e=>e.y<p.height+100),c.current=c.current.filter(e=>e.y<p.height+50&&!e.collected),d.current.forEach(e=>{e.x+=e.vx,e.y+=e.vy,e.life-=3*g}),d.current=d.current.filter(e=>e.life>0),A()){f.screen="gameover",f.combo=0,f.boostActive=!1,f.boostTime=0,T(v.x,v.y,12);let e={score:f.score,coins:f.coins,maxCombo:f.maxCombo,date:new Date().toISOString()},t=localStorage.getItem("pingo_highscore"),r=t?JSON.parse(t):null;(!r||f.score>r.score)&&(localStorage.setItem("pingo_highscore",JSON.stringify(e)),b(e)),x({...f}),o.current=requestAnimationFrame(P);return}x({...f})}let C=(p.width-210)/2;m.fillStyle=j.border,m.globalAlpha=.3,m.fillRect(C,0,210,p.height),m.globalAlpha=1,m.strokeStyle=j.border,m.lineWidth=1,m.setLineDash([20,15]);let R=f.distance%35;for(let e=1;e<3;e++){let t=y(e)-35;m.beginPath(),m.moveTo(t,-35+R),m.lineTo(t,p.height),m.stroke()}if(m.setLineDash([]),m.strokeStyle=j.muted,m.lineWidth=1,m.beginPath(),m.moveTo(C,0),m.lineTo(C,p.height),m.stroke(),m.beginPath(),m.moveTo(C+210,0),m.lineTo(C+210,p.height),m.stroke(),c.current.forEach(e=>{if(e.collected)return;let t=y(e.lane),r=e.y;m.strokeStyle=j.foreground,m.lineWidth=1.5,m.beginPath(),m.arc(t,r,10,0,2*Math.PI),m.stroke(),m.fillStyle=j.foreground,m.beginPath(),m.arc(t,r,3,0,2*Math.PI),m.fill()}),i.current.forEach(e=>{let t=y(e.lane),r=e.y;m.fillStyle=j.foreground,m.fillRect(t-e.width/2,r-e.height/2,e.width,e.height)}),d.current.forEach(e=>{m.globalAlpha=e.life/e.maxLife*.6,m.fillStyle=j.muted,m.beginPath(),m.arc(e.x,e.y,e.size*(e.life/e.maxLife),0,2*Math.PI),m.fill()}),m.globalAlpha=1,("playing"===f.screen||"gameover"===f.screen)&&(m.save(),m.translate(v.x,v.y),m.rotate(v.rotation*Math.PI/180),m.strokeStyle=j.foreground,m.lineWidth=2,m.strokeRect(-16,-28,32,56),m.beginPath(),m.moveTo(-10,-18),m.lineTo(10,-18),m.stroke(),m.lineWidth=1,m.beginPath(),m.moveTo(0,-12),m.lineTo(0,20),m.stroke(),m.restore()),"playing"===f.screen){m.fillStyle=j.foreground,m.font='500 20px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',m.textAlign="left",m.fillText(`${f.score}`,20,36),m.fillStyle=j.muted,m.font='400 14px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',m.fillText(`${f.coins} coins`,20,56);let e=k(f.combo);e>1&&(m.fillStyle=j.foreground,m.font='500 16px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',m.textAlign="right",m.fillText(`x${e}`,p.width-20,36)),f.combo>1&&(m.fillStyle=j.muted,m.font='400 12px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',m.textAlign="right",m.fillText(`${f.combo} streak`,p.width-20,54));let t=p.width/2-60,r=f.boostActive?f.boostTime/4.5:Math.min(1,f.boostCharge/100);m.strokeStyle=j.muted,m.lineWidth=1,m.strokeRect(t,18,120,6),m.fillStyle=f.boostActive?j.foreground:j.muted,m.globalAlpha=f.boostActive?1:.7,m.fillRect(t,18,120*r,6),m.globalAlpha=1,m.fillStyle=j.muted,m.font='400 10px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',m.textAlign="center",m.fillText(f.boostActive?"BOOST!":"Boost",t+60,14)}o.current=requestAnimationFrame(P)},[p,y,A,M,N,T,k,S]),R=(0,r.useCallback)(()=>{let e=a.current,t=l.current;"home"===e.screen||"gameover"===e.screen?E():"playing"===e.screen&&t.switchProgress>=.8&&(t.targetLane=(t.targetLane+1)%3,t.switchProgress=0)},[]),E=(0,r.useCallback)(()=>{a.current={screen:"playing",score:0,coins:0,combo:0,maxCombo:0,distance:0,speed:4.5,nearMisses:0,boostCharge:0,boostActive:!1,boostTime:0,boostsTriggered:0},l.current={lane:1,targetLane:1,x:y(1),y:p.height-120,rotation:0,switchProgress:1},i.current=[],c.current=[],d.current=[],u.current=200,h.current=100,m.current=0,x(a.current)},[y,p.height]);return(0,r.useEffect)(()=>{let e=()=>{v({width:Math.min(340,window.innerWidth-40),height:Math.min(600,window.innerHeight-160)})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{"playing"===a.current.screen&&(l.current.y=p.height-120,l.current.x=y(l.current.lane))},[p,y]),(0,r.useEffect)(()=>{let e=localStorage.getItem("pingo_highscore");e&&b(JSON.parse(e))},[]),(0,r.useEffect)(()=>{j();let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{setTimeout(j,50)};return e.addEventListener("change",t),l.current.x=y(1),l.current.y=p.height-120,s.current=0,o.current=requestAnimationFrame(P),()=>{cancelAnimationFrame(o.current),e.removeEventListener("change",t)}},[P,y,p.height,j]),(0,r.useEffect)(()=>{let e=e=>{("Space"===e.code||"ArrowRight"===e.code||"ArrowLeft"===e.code)&&(e.preventDefault(),R())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[R]),(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center px-6 py-12 bg-[var(--background)]",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("canvas",{ref:e,width:p.width,height:p.height,onClick:R,onTouchStart:e=>{e.preventDefault(),R()},className:"cursor-pointer touch-none border border-[var(--border)]"}),"home"===g.screen&&(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[var(--background)]/95 border border-[var(--border)]",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-3",children:"One-Button"}),(0,t.jsx)("h1",{className:"text-3xl font-medium tracking-tight text-[var(--foreground)] mb-8",children:"Drift"}),(0,t.jsxs)("div",{className:"mb-10 text-center",children:[(0,t.jsx)("p",{className:"text-[var(--muted)] text-sm mb-1",children:"Tap or press Space to switch lanes"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Collect coins + near misses to fill Boost"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Boost doubles points and adds speed"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Streaks raise your score multiplier"})]}),(0,t.jsx)("button",{onClick:R,className:"px-8 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Play"}),f&&(0,t.jsxs)("div",{className:"mt-10 text-center",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] mb-1",children:"Best"}),(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:f.score})]})]}),"gameover"===g.screen&&(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[var(--background)]/95 border border-[var(--border)]",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-6",children:"Game Over"}),(0,t.jsx)("p",{className:"text-4xl font-medium text-[var(--foreground)] mb-6",children:g.score}),(0,t.jsxs)("div",{className:"flex flex-wrap justify-center gap-10 mb-8 text-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:g.coins}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Coins"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:[g.maxCombo,"x"]}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Combo"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:g.nearMisses}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Near"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:g.boostsTriggered}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Boosts"})]})]}),f&&g.score>=f.score&&(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] mb-6",children:"New best score"}),(0,t.jsx)("button",{onClick:R,className:"px-8 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Play Again"}),f&&g.score<f.score&&(0,t.jsxs)("p",{className:"mt-8 text-xs text-[var(--muted)]",children:["Best: ",f.score]})]}),"playing"===g.screen&&(0,t.jsx)("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2",children:(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"tap anywhere • build streaks"})})]}),(0,t.jsx)("p",{className:"mt-8 text-xs text-[var(--muted)]",children:"Space / Tap to switch lanes • Fill Boost for double points"})]})}e.s(["default",()=>o])}]);