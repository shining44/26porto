(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84991,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function s(){let[e,s]=(0,r.useState)({screen:"home",switches:[!1,!1,!1],trains:[],score:0,delivered:0,streak:0,bestStreak:0,lives:3,tickMs:300,mode:"daily",seed:"",spawnCounter:0}),[a,o]=(0,r.useState)({bestScore:0,lastDaily:"",lastDailyScore:0}),[l,n]=(0,r.useState)(!1),[i,c]=(0,r.useState)(0),d=(0,r.useRef)(()=>Math.random()),x=(0,r.useRef)(null),u=(0,r.useRef)(0);(0,r.useEffect)(()=>{let e=localStorage.getItem("switchyard_data");e&&o(JSON.parse(e))},[]);let h=(0,r.useCallback)(e=>{let t=["R","G","B"][Math.floor(3*e())];return u.current++,{id:u.current,color:t,progress:0,pathAtSwitch0:null,pathAtSwitch1:null,pathAtSwitch2:null}},[]),m=(0,r.useCallback)(e=>{let t=e.progress;if(t<=25)return{x:20+t/25*80,y:150};let r=!0===e.pathAtSwitch0;if(t<=50){let e=(t-25)/25;return r?{x:100+80*e,y:150-70*e}:{x:100+80*e,y:150+70*e}}if(t<=75){let s=(t-50)/25;return r?!0===e.pathAtSwitch1?{x:180+100*s,y:80-30*s}:{x:180+80*s,y:80+70*s}:!0===e.pathAtSwitch2?{x:180+100*s,y:220+30*s}:{x:180+80*s,y:220-70*s}}let s=(t-75)/25;return r&&!0===e.pathAtSwitch1?{x:280+100*s,y:50}:r||!0!==e.pathAtSwitch2?{x:260+120*s,y:150}:{x:280+100*s,y:250}},[]),v=(0,r.useCallback)(e=>!0===e.pathAtSwitch0&&!0===e.pathAtSwitch1?"R":!1===e.pathAtSwitch0&&!0===e.pathAtSwitch2?"G":"B",[]),b=(0,r.useCallback)((e,t,r)=>{o(s=>{let a={...s};return e>s.bestScore&&(a.bestScore=e),"daily"===t&&(a.lastDaily=r,a.lastDailyScore=e),localStorage.setItem("switchyard_data",JSON.stringify(a)),a})},[]),g=(0,r.useCallback)(()=>{s(e=>{if("playing"!==e.screen)return e;let t=e.trains.map(t=>{let r={...t,progress:t.progress+4};return r.progress>=25&&null===r.pathAtSwitch0&&(r.pathAtSwitch0=e.switches[0]),r.progress>=50&&(!0===r.pathAtSwitch0&&null===r.pathAtSwitch1&&(r.pathAtSwitch1=e.switches[1]),!1===r.pathAtSwitch0&&null===r.pathAtSwitch2&&(r.pathAtSwitch2=e.switches[2])),r}),r=e.score,s=e.delivered,a=e.streak,o=e.bestStreak,l=e.lives,n=e.tickMs,i=[];t.forEach((e,t)=>{e.progress>=100&&(i.push(t),v(e)===e.color?(r+=10+2*a,s++,++a>o&&(o=a),s%5==0&&(n=Math.max(100,n-15))):(l--,a=0))}),t=t.filter((e,t)=>!i.includes(t));let c=!1;for(let e=0;e<t.length&&!c;e++)for(let r=e+1;r<t.length&&!c;r++){let s=m(t[e]),a=m(t[r]);20>Math.sqrt((s.x-a.x)**2+(s.y-a.y)**2)&&(c=!0)}if(c||l<=0)return b(r,e.mode,e.seed),{...e,screen:"gameover",score:r,bestStreak:o,trains:t};let x=e.spawnCounter+1,u=Math.min(4,2+Math.floor(s/10));return x>=12&&t.length<u&&(t.push(h(d.current)),x=0),{...e,trains:t,score:r,delivered:s,streak:a,bestStreak:o,lives:l,tickMs:n,spawnCounter:x}})},[m,v,h,b]);(0,r.useEffect)(()=>{if("playing"===e.screen)return x.current=setInterval(g,e.tickMs),()=>{x.current&&clearInterval(x.current)}},[e.screen,e.tickMs,g]),(0,r.useEffect)(()=>{let t=t=>{"playing"===e.screen&&("1"===t.key?f(0):"2"===t.key?f(1):"3"===t.key&&f(2))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e.screen]);let p=(0,r.useCallback)(e=>{let t,r="daily"===e?(t=new Date,`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`):`practice-${Date.now()}`;d.current=function(e){let t=0x811c9dc5;for(let r=0;r<e.length;r++)t^=e.charCodeAt(r),t=Math.imul(t,0x1000193);return function(){return t^=t>>>16,t=Math.imul(t,0x85ebca6b),t^=t>>>13,t=Math.imul(t,0xc2b2ae35),((t^=t>>>16)>>>0)/0x100000000}}(r),u.current=0,s({screen:"playing",switches:[!1,!1,!1],trains:[h(d.current)],score:0,delivered:0,streak:0,bestStreak:0,lives:3,tickMs:300,mode:e,seed:r,spawnCounter:0})},[h]),f=(0,r.useCallback)(e=>{let t=Date.now();t-i<100||(c(t),s(t=>{if("playing"!==t.screen)return t;let r=[...t.switches];return r[e]=!r[e],{...t,switches:r}}))},[i]),y=(0,r.useCallback)(()=>{let{seed:t,score:r,delivered:s,bestStreak:a,tickMs:o}=e,l=`Switchyard ${t}
Score: ${r}
Delivered: ${s} (Streak ${a})
Speed: ${o}ms`;navigator.clipboard.writeText(l)},[e]);return(0,t.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center px-6 py-12 bg-[var(--background)]",children:(0,t.jsxs)("div",{className:"w-full max-w-md",children:["home"===e.screen&&(0,t.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-3",children:"One-Click Routing"}),(0,t.jsx)("h1",{className:"text-3xl font-medium tracking-tight text-[var(--foreground)] mb-8",children:"Switchyard"}),(0,t.jsxs)("div",{className:"mb-8 text-center",children:[(0,t.jsx)("p",{className:"text-[var(--muted)] text-sm mb-2",children:"Route trains to matching exits"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Toggle switches before trains pass them"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"R→Red (top), G→Green (bottom), B→Blue (middle)"}),(0,t.jsx)("p",{className:"text-[var(--muted)] text-xs",children:"Collisions or wrong exits cost lives"})]}),(0,t.jsxs)("div",{className:"flex gap-3 mb-8",children:[(0,t.jsx)("button",{onClick:()=>p("daily"),className:"px-6 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Daily"}),(0,t.jsx)("button",{onClick:()=>p("practice"),className:"px-6 py-3 text-sm font-medium border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"Practice"})]}),a.bestScore>0&&(0,t.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:["Best: ",a.bestScore]})]}),"playing"===e.screen&&(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsxs)("div",{className:"w-full flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.score}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"score"})]}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("p",{className:"text-sm text-[var(--foreground)]",children:["♥".repeat(e.lives),"♡".repeat(3-e.lives)]})}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.streak}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"streak"})]})]}),(()=>{let{switches:r,trains:s}=e;return(0,t.jsxs)("div",{className:"relative border border-[var(--border)]",style:{width:400,height:300},children:[(0,t.jsxs)("svg",{className:"absolute inset-0",width:400,height:300,children:[(0,t.jsx)("line",{x1:"20",y1:"150",x2:"100",y2:"150",stroke:"var(--muted)",strokeWidth:"3"}),(0,t.jsx)("line",{x1:"100",y1:"150",x2:"180",y2:"80",stroke:"var(--muted)",strokeWidth:"3",strokeOpacity:r[0]?1:.3}),(0,t.jsx)("line",{x1:"100",y1:"150",x2:"180",y2:"220",stroke:"var(--muted)",strokeWidth:"3",strokeOpacity:r[0]?.3:1}),(0,t.jsx)("line",{x1:"180",y1:"80",x2:"180",y2:"80",stroke:"var(--muted)",strokeWidth:"3"}),(0,t.jsx)("line",{x1:"180",y1:"80",x2:"280",y2:"50",stroke:"var(--muted)",strokeWidth:"3",strokeOpacity:r[1]?1:.3}),(0,t.jsx)("line",{x1:"180",y1:"80",x2:"260",y2:"150",stroke:"var(--muted)",strokeWidth:"3",strokeOpacity:r[1]?.3:1}),(0,t.jsx)("line",{x1:"180",y1:"220",x2:"280",y2:"250",stroke:"var(--muted)",strokeWidth:"3",strokeOpacity:r[2]?1:.3}),(0,t.jsx)("line",{x1:"180",y1:"220",x2:"260",y2:"150",stroke:"var(--muted)",strokeWidth:"3",strokeOpacity:r[2]?.3:1}),(0,t.jsx)("line",{x1:"280",y1:"50",x2:"380",y2:"50",stroke:"var(--muted)",strokeWidth:"3"}),(0,t.jsx)("line",{x1:"280",y1:"250",x2:"380",y2:"250",stroke:"var(--muted)",strokeWidth:"3"}),(0,t.jsx)("line",{x1:"260",y1:"150",x2:"380",y2:"150",stroke:"var(--muted)",strokeWidth:"3"})]}),(0,t.jsx)("div",{className:"absolute right-2 top-[35px] text-sm font-bold border-2 border-[var(--foreground)] px-3 py-1 bg-[var(--background)]",children:"R"}),(0,t.jsx)("div",{className:"absolute right-2 top-[135px] text-sm font-bold border-2 border-[var(--foreground)] px-3 py-1 bg-[var(--background)]",children:"B"}),(0,t.jsx)("div",{className:"absolute right-2 top-[235px] text-sm font-bold border-2 border-[var(--foreground)] px-3 py-1 bg-[var(--background)]",children:"G"}),(0,t.jsx)("div",{className:"absolute left-1 top-[138px] text-xs text-[var(--muted)]",children:"IN"}),(0,t.jsx)("button",{onClick:()=>f(0),className:`absolute w-8 h-8 flex items-center justify-center text-sm font-bold border-2 transition-all ${r[0]?"bg-[var(--foreground)] text-[var(--background)] border-[var(--foreground)]":"bg-[var(--background)] text-[var(--foreground)] border-[var(--foreground)]"}`,style:{left:84,top:134},children:"1"}),(0,t.jsx)("button",{onClick:()=>f(1),className:`absolute w-8 h-8 flex items-center justify-center text-sm font-bold border-2 transition-all ${r[1]?"bg-[var(--foreground)] text-[var(--background)] border-[var(--foreground)]":"bg-[var(--background)] text-[var(--foreground)] border-[var(--foreground)]"}`,style:{left:164,top:64},children:"2"}),(0,t.jsx)("button",{onClick:()=>f(2),className:`absolute w-8 h-8 flex items-center justify-center text-sm font-bold border-2 transition-all ${r[2]?"bg-[var(--foreground)] text-[var(--background)] border-[var(--foreground)]":"bg-[var(--background)] text-[var(--foreground)] border-[var(--foreground)]"}`,style:{left:164,top:204},children:"3"}),s.map(e=>{let r=m(e);return(0,t.jsx)("div",{className:"absolute w-6 h-6 flex items-center justify-center text-xs font-bold border-2 border-[var(--foreground)] bg-[var(--background)] transition-all duration-75 rounded-full",style:{left:r.x-12,top:r.y-12},children:e.color},e.id)})]})})(),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Press 1/2/3 or click switches"}),(0,t.jsx)("button",{onClick:()=>n(!0),className:"px-2 py-1 text-xs border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"?"})]})]}),"gameover"===e.screen&&(0,t.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] uppercase tracking-widest mb-3",children:"Derailed"}),(0,t.jsx)("h2",{className:"text-2xl font-medium text-[var(--foreground)] mb-6",children:"Game Over"}),(0,t.jsx)("p",{className:"text-4xl font-medium text-[var(--foreground)] mb-6",children:e.score}),(0,t.jsxs)("div",{className:"flex gap-8 mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.delivered}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Delivered"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-[var(--foreground)]",children:e.bestStreak}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Best Streak"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 mb-6",children:[(0,t.jsx)("button",{onClick:y,className:"px-6 py-3 text-sm font-medium border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Copy Share"}),(0,t.jsx)("button",{onClick:()=>p("practice"),className:"px-6 py-3 text-sm font-medium border border-[var(--muted)] text-[var(--muted)] hover:border-[var(--foreground)] hover:text-[var(--foreground)] transition-colors",children:"Play Again"})]}),a.bestScore>0&&(0,t.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:["Best: ",a.bestScore]})]}),l&&(0,t.jsx)("div",{className:"fixed inset-0 bg-[var(--background)]/95 flex items-center justify-center p-6 z-50",children:(0,t.jsxs)("div",{className:"max-w-sm text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-[var(--foreground)] mb-4",children:"How to Play"}),(0,t.jsxs)("div",{className:"text-sm text-[var(--muted)] space-y-2 mb-6",children:[(0,t.jsx)("p",{children:"Trains spawn at the left and travel right."}),(0,t.jsx)("p",{children:"Toggle switches BEFORE trains reach them."}),(0,t.jsx)("p",{children:"Once a train passes a switch, its path is locked."}),(0,t.jsx)("p",{children:"Route to matching exits: R→Red, G→Green, B→Blue"}),(0,t.jsx)("p",{children:"Wrong exits cost 1 life. Collisions end the game."})]}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"px-6 py-2 text-sm border border-[var(--foreground)] text-[var(--foreground)] hover:bg-[var(--foreground)] hover:text-[var(--background)] transition-colors",children:"Got it"})]})})]})})}e.s(["default",()=>s])}]);